{% extends "admin/change_list.html" %}  {% block content_title %}
<h1> Paper Summary </h1>
{% endblock %} {% block result_list %} {% if action_form and actions_on_top and cl.show_admin_actions %}{% endif %} {% if action_form and actions_on_bottom and cl.show_admin_actions %}{% endif %}
<div class="results">
    <table>
        <thead>
            <tr>
                <th>
                    <div class="text">
                        <a href="#">Title</a>
                    </div>
                </th>
                <th>
                    <div class="text">
                        <a href="#">Publication Date</a>
                    </div>
                </th>
                <th>
                    <div class="text">
                        <a href="#">Published</a>
                    </div>
                </th>
            </tr>
        </thead>
        <tbody>
            {% for row in papers %}
            <tr class="{% cycle 'row1' 'row2' %}">
                <td> {{ row.title }} </td>
                <td> {{ row.publication_date}} </td>
                <td> <input type="checkbox" id="{{row.id}}" {% if row.published %} checked {% endif %} class="action-select"> </td>
            </tr>
            {% endfor %}
        </tbody>

    </table>
</div>
<script>
    let httpRequest;
    let mycheckboxs = document.querySelectorAll('input[type="checkbox"]');
    for(let i =0; i< mycheckboxs.length; i++){
        mycheckboxs[i].onclick= () =>{
            console.log(mycheckboxs[i].id)
            httpRequest = new XMLHttpRequest();
            if (!httpRequest) {
                alert('Giving up :( Cannot create an XMLHTTP instance');
                return false;
            }
            httpRequest.onreadystatechange = alertContents;
            httpRequest.open('GET', `http://127.0.0.1:8000/checkmate/${mycheckboxs[i].id}/`);
            httpRequest.send();
        };

    }
    function alertContents() {
        if (httpRequest.readyState === XMLHttpRequest.DONE) {
        if (httpRequest.status === 200) {
            console.log(httpRequest.responseText);
        } else {
            alert('There was a problem with the request.');
        }
        }
    }
    

</script>

{% endblock %} {% block pagination %}{% endblock %}